<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(2),u=e(3),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}finally{f.emit("fn-end",[c.now()],t)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],4:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=m(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){v[e]=m(e).concat(n)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(t)}function g(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var v={},y={},b={on:l,emit:t,get:w,listeners:m,context:n,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(2),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=h.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+h.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===d.readyState&&i()}function i(){f("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),f=e("handle"),c=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1044.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=n.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),f("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script>
<meta charset="UTF-8">
<title>欢迎来到3D签到！</title>
<link rel="stylesheet" href="./css/3d.css">
<link rel="stylesheet" href="./css/style.css" media="screen" type="text/css">
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>

</head>
<style>
body{padding:0;margin:0;font:12px/18px microsoft yahei,arial;background-image:url('http://default.ysqywx.sobeycloud.com/addons/meepo_bigerwall/template/mobile/newmobile/qd/3d/images/bg.jpg');background-size:100% 100%;overflow:hidden;}
.join_word{background-color:#000;color:#fff;text-align:Center;font-size:24px;min-height:40px;line-height:40px;display:none;padding:10px 0;word-break:break-all;}
.loading{
display: table;
position: absolute;
background-color: #333;
opacity:0.8;
width:100%;
height:100%;
z-index:999;
text-align: center;
vertical-align: middle;
}
.loading_card{
    display: table-cell;
    text-align: center;
    vertical-align: middle;
    height: 100%;
}
</style>
<body >

<div class="loading">
	  <div class="loading_card">
        <span class="loading_gif"><img src="./images/hqy_logo.png"/></span>
      </div>
</div>
<!-- <div class="signin_ecode">
	<a href="javascript:;"><img src="./images/qrcode.jpg" class="ecode_img"></a>
	<p class="join_word">扫码关注、发送签到即可完成签到！</p>
</div> -->
<input type="hidden" name="logo_base64" id="logo_base64" value="" />
<div id="container"></div>
<canvas class="canvas" style="width:100%;height:100%;display:none"></canvas>
<span class="signBox">
    	<img src="" class="imgShow">    	
        <p class="nameLine">
        	<strong class="name"></strong>
            <br /><br />
            <span class="textLine"><i></i><span class="text_scrool"><u class="text"></u></span></span>
        </p>            
</span>
<input type="hidden" id="max_id" name="max_id" value="2">
<input type="hidden" id="mid" name="mid" value="28">
<script type="text/javascript">
var sign_persons = parseInt(100);
if(sign_persons==0){
	sign_persons = 300;
}
var is_show_info = parseInt(0);
var personArray = new Array;
var tmp = {
	id: 480,
	image : "./images/001.png",
	name  : "菜头",
	company  : "",
	position : "",
	text  : "祝福你们",
};
var person_info = eval(tmp);
personArray.push(person_info);
var tmp = {
	id: 481,
	image : "./images/002.png",
	name  : "车轱辘",
	company  : "",
	position : "",
	text  : "祝福你们",
};
var person_info = eval(tmp);
personArray.push(person_info);
var edit_personArray = new Array;
var table = new Array;
var avatar = new Array;

for (var i=0;i<sign_persons;i++){
	table[i]=new Object();	
	if(i<personArray.length){
		if(typeof(personArray[i].image) == "undefined" ){
			avatar[i] = "./images/hqy_logo.png";
		}else{
			avatar[i] = personArray[i].image;
		}
	}else{
		if(personArray.length ==0){
			avatar[i] = "./images/hqy_logo.png";
		}else{
			avatar[i] = personArray[Math.floor(Math.random() * personArray.length)].image;
		}
	}
	table[i].src=avatar[i];
	table[i].p_x = i%30+1;
	table[i].p_y = Math.floor(i/30)+1;
}
var table_time = parseInt(10);
var sphere_time = parseInt(20);
var	helix_time = parseInt(20);
var grid_time = parseInt(20);
var text  = "logo不存在";
var line = 0;
var logo_url = "images/hqy_3d_logo.png";
if(logo_url!=''){ 
	if(logo_url.indexOf("meepo_bigerwall")>0){
			logo_url = "./"+logo_url.replace("..", "");
	}else{
			logo_url = "./images/hqy_3d_logo.png";
	}
}
if(logo_url=='' && text!=''){
	if(text.toString().indexOf('/') != -1){
		 line = 1;
	}
}
var gap = parseInt(10);
if(gap==0){
	gap = 10;
}
</script>
<script src="./js/three.min.js"></script>
<script src="./js/tween.min.js"></script>
<script src="./js/CSS3DRenderer.js"></script>
<script src="./js/3d2.js?t=1501207122"></script>
<script src="./js/2d.js?t=1501207122"></script>
<script type="text/javascript">
var signBox = $('.signBox');
var imgShow = $('.imgShow');
var newPic = new Array();
var signNo = 0;
var name;
var job;
var company;
var text;
setInterval(function(){
	if (newPic.length > 0){ 
		var firstInfo = newPic.shift();
		var showImg = firstInfo.image;
		name = firstInfo.name;
		job = firstInfo.job;
		company = firstInfo.company;
		text = firstInfo.text;
		personArray.push(firstInfo);
		$('.element').eq(personArray.length-1).find('img').attr('src',showImg);
	}else{
	  if(personArray.length > 0){
		showImg = personArray[signNo].image;			
		name = personArray[signNo].name;
		job = personArray[signNo].job;
		company = personArray[signNo].company;
		text = personArray[signNo].text;
		signNo = signNo == personArray.length-1 ? 0 : signNo+1;
	  }
	}
	if (is_show_info == 1){
	   if(personArray.length > 0){
		signBox.addClass('imgAnimate').show();
		setTimeout(function(){signBox.hide()},6000);
		imgShow.attr('src',showImg);		
		$('.name').html(name);
		$('.job').html(job);
		$('.company').html(company);
		$('.text').html(text);
		if(text.length>12){ 
			$('.text').addClass('scrollAnitame');
		}else{ 
			$('.text').removeClass('scrollAnitame');
		}
	   }
	}
},10000);	
</script>

<script type="text/javascript">
var new_signer = new Audio(); 
new_signer.src = "./images/new_signer2.mp3";
  setInterval('get_new_sign_list()', 5000);
  function get_new_sign_list(){
  	var data = {};
  	data.rid = $('#mid').val();
  	data.max_id = $('#max_id').val();
  	var responseData = {"errno":0,"message":{"max_id":"","data":[],"edit_message_list":[]}};
  	if(responseData.errno!=0){
  				alert('加载错误');
  				return false;
  	}else{   
			    var result  = responseData.message;
  				if (result.max_id){
					
					new_signer.play();
  					$('#max_id').val(result.max_id);
  				}  			
  				if (result.responseData){   
  					$.each(result.data, function(key, row){
						var tmp = {
						id   : row.id,
						image : row.avatar,
						name  : row.name,
						company : row.company,
						position : row.position,
						text  : row.text
						};
						var person_info = eval(tmp);
						newPic.push(person_info);
  					});
  				}
  				if (result.edit_message_list){   
					$.each(result.edit_message_list, function(key, row){
						var tmp = {
							id : row.id,
							image : row.avatar,
							name  : row.name,
							company : row.company,
							position : row.position,
							text  : row.message
						};
						var person_info = eval(tmp);
						$.each(personArray, function(k, r){
						  if (r.id == row.id){   
						  // 修改原数组
							personArray[k] = person_info;
						  // 修改信息
							tmp.edit_index = k;
							var edit_person_info = eval(tmp);
							edit_personArray.push(edit_person_info);
						  }
						});
					});
				}
  	}	
  	// $.ajax({
  	// 	url : "./index.php?i=28&c=entry&do=new_sign&m=meepo_bigerwall&t="+Math.random(),
  	// 	dataType:"JSON",
  	// 	type:"post",
  	// 	data:data,
  	// 	success:function(data){
  	// 		if(data.errno!=0){
  	// 			alert('加载错误');
  	// 			return false;
  	// 		}else{   
			//     var result  = data.message;
  	// 			if (result.max_id){
					
			// 		new_signer.play();
  	// 				$('#max_id').val(result.max_id);
  	// 			}  			
  	// 			if (result.data){   
  	// 				$.each(result.data, function(key, row){
			// 			var tmp = {
			// 			id   : row.id,
			// 			image : row.avatar,
			// 			name  : row.name,
			// 			company : row.company,
			// 			position : row.position,
			// 			text  : row.text
			// 			};
			// 			var person_info = eval(tmp);
			// 			newPic.push(person_info);
  	// 				});
  	// 			}
  	// 			if (result.edit_message_list){   
			// 		$.each(result.edit_message_list, function(key, row){
			// 			var tmp = {
			// 				id : row.id,
			// 				image : row.avatar,
			// 				name  : row.name,
			// 				company : row.company,
			// 				position : row.position,
			// 				text  : row.message
			// 			};
			// 			var person_info = eval(tmp);
			// 			$.each(personArray, function(k, r){
			// 			  if (r.id == row.id){   
			// 			  // 修改原数组
			// 				personArray[k] = person_info;
			// 			  // 修改信息
			// 				tmp.edit_index = k;
			// 				var edit_person_info = eval(tmp);
			// 				edit_personArray.push(edit_person_info);
			// 			  }
			// 			});
			// 		});
			// 	}
  	// 		}	
  	// 	}
  	// });
  }
  $(document).ready(function () {
	S.init();
	S.ShapeBuilder.imageFile(logo_url, function (obj){
		if(obj.error=='-1'){
			var obj  = S.ShapeBuilder.letter(text);
			var type = 'text';
		}else{
			var type = 'logo';
			
		}
		init(type,obj);
		animate();
		$('.loading').hide();
		transform( targets.table, 2000, 0, table_time);
	});
	
	   $('.signin_ecode .ecode_img').click(function(){
		 if($(this).css("opacity")=='0.5'){
		   $(this).animate({height:"400px",width:"400px",opacity:'1'});
		   $('.join_word').css({'width':"400px"});
		   		    $('.join_word').css({'font-size':"16px"});
		   		   $('.join_word').show();
		 }else{
			$(this).animate({height:'50px',width:'50px',opacity:'0.5'});
			$('.join_word').hide();
		 }
	   });
});

</script>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"76785d398c","applicationID":"35245986","transactionName":"NldabRFZV0MCVBcPWQ8dbUsKFxZRE0dMD1gFV0AXE1BJ","queueTime":0,"applicationTime":50,"atts":"GhBZG1lDRE0=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>